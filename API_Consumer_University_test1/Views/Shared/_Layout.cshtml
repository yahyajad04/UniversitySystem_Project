@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@{
    var roles = new List<string>();
    var user = await UserManager.GetUserAsync(User);
    if (user != null)
    {
        roles = (await UserManager.GetRolesAsync(user)).ToList();
    }
}
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - University</title>

    <!-- AdminLTE + Bootstrap + Icons -->
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/lib/admin-lte/css/adminlte.min.css" />
    <link rel="stylesheet" href="~/lib/bootswatch/lux/bootstrap.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="hold-transition sidebar-mini">
    <div class="wrapper">

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item d-flex align-items-center">
                    <!-- 👇 Hamburger button -->
                    <a class="nav-link d-flex align-items-center" data-widget="pushmenu" href="#" role="button">
                        <i class="bi bi-list fs-3"></i>
                    </a>
                </li>
                </ul>
                            <!--begin::Fullscreen Toggle-->
        <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i>
                <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none"></i>
              </a>
            </li>
            <!--end::Fullscreen Toggle-->
            <!--begin::User Menu Dropdown-->
            <li class="nav-item dropdown user-menu">
              <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                <img
                  src="~/lib/admin-lte/img/user2-160x160.jpg"
                  class="user-image rounded-circle shadow"
                  alt="User Image"
                />
                     <span class="d-none d-md-inline">@UserManager.GetUserName(User)</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                <!--begin::User Image-->
                <li class="user-header text-bg-primary">
                  <img src="~/lib/admin-lte/img/user2-160x160.jpg"
                    class="rounded-circle shadow"
                    alt="User Image"
                  />
                  <p>
                        @UserManager.GetUserName(User) - @string.Join(", ", roles)
                  </p>
                </li>
                <!--end::User Image-->
                <!--begin::Menu Body-->
                <li class="user-body">
                  <!--begin::Row-->
                  <div class="row">
                  </div>
                  <!--end::Row-->
                </li>
                <!--end::Menu Body-->
                <!--begin::Menu Footer-->
                <li class="user-footer">
                            @await Html.PartialAsync("_LoginPartial")
                </li>
                <!--end::Menu Footer-->
              </ul>
            </li>
            <!--end::User Menu Dropdown-->
            </ul>
        </nav>
        <!-- /.navbar -->
        <!-- Sidebar -->
        <aside class="main-sidebar sidebar-dark-primary elevation-4 d-flex flex-column">
            <!-- Brand Logo -->
            <a asp-controller="Home" asp-action="Index" class="brand-link">
                <img src="~/lib/admin-lte/img/AdminLTELogo.png"
                     alt="Logo"
                     class="brand-image img-circle elevation-3">
                <span class="brand-text font-weight-light">University</span>
            </a>

            <!-- Sidebar Menu -->
            <div class="sidebar">
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-lte-toggle="treeview" role="menu">
                        <li class="nav-item">
                            <a asp-controller="Home" asp-action="Index" class="nav-link">
                                <i class="nav-icon fas fa-user-graduate"></i>
                                <p>Home</p>
                            </a>
                        </li>
                         @if (SignInManager.IsSignedIn(User))
                        {
                            @if (User.IsInRole("Student"))
                            {
                                <li class="nav-item">
                                    <a asp-controller="Students" asp-action="Enroll" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Enroll</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a asp-controller="Students" asp-action="RegesteredCourses" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Enrolled Courses</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a asp-controller="Students" asp-action="ShowProfile" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Profile</p>
                                    </a>
                                </li>
                            }
                            @if (User.IsInRole("Admin"))
                            {
                                <li class="nav-item">
                                    <a asp-controller="Students" asp-action="Index" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Students</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a asp-controller="Majors" asp-action="Index" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Majors</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a asp-controller="Courses" asp-action="Index" class="nav-link">
                                        <i class="nav-icon fas fa-book"></i>
                                        <p>Courses</p>
                                    </a>
                                </li>
                            }
                        }
                    </ul>
                </nav>
            </div>
        </aside>
        <!-- /.sidebar -->
        <!-- Content Wrapper -->
        <div class="content-wrapper">
            <section class="content pt-3">
                <div class="container-fluid">
                    @RenderBody()
                </div>
            </section>
        </div>

        <!-- Footer -->
        <footer class="main-footer">
            <strong>&copy; @DateTime.Now.Year - University - </strong>
            <a asp-action="Privacy" asp-controller="Home">Privacy</a>
        </footer>
    </div>

    <!-- Scripts -->

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/admin-lte/js/adminlte.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fsButton = document.querySelector('[data-lte-toggle="fullscreen"]');
            if (!fsButton) return;

            fsButton.addEventListener('click', function(e) {
                e.preventDefault();
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                    fsButton.querySelector('[data-lte-icon="maximize"]').style.display = 'none';
                    fsButton.querySelector('[data-lte-icon="minimize"]').style.display = 'inline';
                } else {
                    document.exitFullscreen();
                    fsButton.querySelector('[data-lte-icon="maximize"]').style.display = 'inline';
                    fsButton.querySelector('[data-lte-icon="minimize"]').style.display = 'none';
                }
            });
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>

